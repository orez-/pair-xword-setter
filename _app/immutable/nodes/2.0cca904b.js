import{s as De,f as D,a as Z,l as H,g as L,h as R,d as m,c as Q,m as K,j as A,k as Mt,i as N,x as v,A as re,B as Y,y as he,C as ge,D as Le,E as ct,o as ut,e as Ve,n as oe,p as ft,F as se,G as Rt,H as at,I as dt,J as Tt}from"../chunks/scheduler.dc23dc69.js";import{S as ze,i as Ue,b as Pe,d as xe,m as We,a as Be,t as Ne,e as qe}from"../chunks/index.df494a3a.js";const Ot=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function te(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}let X;const ne=new Array(32).fill(void 0);ne.push(void 0,null,!0,!1);function E(t){return ne[t]}let de=ne.length;function Vt(t){t<36||(ne[t]=de,de=t)}function we(t){const e=E(t);return Vt(t),e}const _t=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});_t.decode();let me=new Uint8Array;function _e(){return me.byteLength===0&&(me=new Uint8Array(X.memory.buffer)),me}function Ee(t,e){return _t.decode(_e().subarray(t,t+e))}function B(t){de===ne.length&&ne.push(ne.length+1);const e=de;return de=ne[e],ne[e]=t,e}let ke=0;const pe=new TextEncoder("utf-8"),Pt=typeof pe.encodeInto=="function"?function(t,e){return pe.encodeInto(t,e)}:function(t,e){const n=pe.encode(t);return e.set(n),{read:t.length,written:n.length}};function He(t,e,n){if(n===void 0){const c=pe.encode(t),u=e(c.length);return _e().subarray(u,u+c.length).set(c),ke=c.length,u}let l=t.length,s=e(l);const o=_e();let r=0;for(;r<l;r++){const c=t.charCodeAt(r);if(c>127)break;o[s+r]=c}if(r!==l){r!==0&&(t=t.slice(r)),s=n(s,l,l=r+t.length*3);const c=_e().subarray(s+r,s+l),u=Pt(t,c);r+=u.written}return ke=r,s}function Ie(t){return t==null}let ye=new Int32Array;function le(){return ye.byteLength===0&&(ye=new Int32Array(X.memory.buffer)),ye}let ve=new Float64Array;function xt(){return ve.byteLength===0&&(ve=new Float64Array(X.memory.buffer)),ve}function Se(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const s=t.description;return s==null?"Symbol":`Symbol(${s})`}if(e=="function"){const s=t.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(t)){const s=t.length;let o="[";s>0&&(o+=Se(t[0]));for(let r=1;r<s;r++)o+=", "+Se(t[r]);return o+="]",o}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let l;if(n.length>1)l=n[1];else return toString.call(t);if(l=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:l}function Wt(t,e){return _e().subarray(t/1,t/1+e)}function Bt(t){try{const r=X.__wbindgen_add_to_stack_pointer(-16);X.generate_puz(r,B(t));var e=le()[r/4+0],n=le()[r/4+1],l=le()[r/4+2],s=le()[r/4+3];if(s)throw we(l);var o=Wt(e,n).slice();return X.__wbindgen_free(e,n*1),o}finally{X.__wbindgen_add_to_stack_pointer(16)}}function Ce(t,e){try{return t.apply(this,e)}catch(n){X.__wbindgen_exn_store(B(n))}}async function Nt(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(l){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",l);else throw l}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function qt(){const t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(e){we(e)},t.wbg.__wbindgen_is_string=function(e){return typeof E(e)=="string"},t.wbg.__wbindgen_error_new=function(e,n){const l=new Error(Ee(e,n));return B(l)},t.wbg.__wbindgen_string_get=function(e,n){const l=E(n),s=typeof l=="string"?l:void 0;var o=Ie(s)?0:He(s,X.__wbindgen_malloc,X.__wbindgen_realloc),r=ke;le()[e/4+1]=r,le()[e/4+0]=o},t.wbg.__wbindgen_is_object=function(e){const n=E(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_is_undefined=function(e){return E(e)===void 0},t.wbg.__wbindgen_in=function(e,n){return E(e)in E(n)},t.wbg.__wbindgen_object_clone_ref=function(e){const n=E(e);return B(n)},t.wbg.__wbindgen_string_new=function(e,n){const l=Ee(e,n);return B(l)},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return E(e)==E(n)},t.wbg.__wbindgen_boolean_get=function(e){const n=E(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_number_get=function(e,n){const l=E(n),s=typeof l=="number"?l:void 0;xt()[e/8+1]=Ie(s)?0:s,le()[e/4+0]=!Ie(s)},t.wbg.__wbg_getwithrefkey_15c62c2b8546208d=function(e,n){const l=E(e)[E(n)];return B(l)},t.wbg.__wbg_set_20cbc34131e76824=function(e,n,l){E(e)[we(n)]=we(l)},t.wbg.__wbg_get_57245cc7d7c7619d=function(e,n){const l=E(e)[n>>>0];return B(l)},t.wbg.__wbg_length_6e3bbe7c8bd4dbd8=function(e){return E(e).length},t.wbg.__wbindgen_is_function=function(e){return typeof E(e)=="function"},t.wbg.__wbg_new_268f7b7dd3430798=function(){return B(new Map)},t.wbg.__wbg_next_579e583d33566a86=function(e){const n=E(e).next;return B(n)},t.wbg.__wbg_next_aaef7c8aa5e212ac=function(){return Ce(function(e){const n=E(e).next();return B(n)},arguments)},t.wbg.__wbg_done_1b73b0672e15f234=function(e){return E(e).done},t.wbg.__wbg_value_1ccc36bc03462d71=function(e){const n=E(e).value;return B(n)},t.wbg.__wbg_iterator_6f9d4f28845f426c=function(){return B(Symbol.iterator)},t.wbg.__wbg_get_765201544a2b6869=function(){return Ce(function(e,n){const l=Reflect.get(E(e),E(n));return B(l)},arguments)},t.wbg.__wbg_call_97ae9d8645dc388b=function(){return Ce(function(e,n){const l=E(e).call(E(n));return B(l)},arguments)},t.wbg.__wbg_new_0b9bfdd97583284e=function(){const e=new Object;return B(e)},t.wbg.__wbg_isArray_27c46c67f498e15d=function(e){return Array.isArray(E(e))},t.wbg.__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b=function(e){let n;try{n=E(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_set_933729cf5b66ac11=function(e,n,l){const s=E(e).set(E(n),E(l));return B(s)},t.wbg.__wbg_isSafeInteger_dfa0593e8d7ac35a=function(e){return Number.isSafeInteger(E(e))},t.wbg.__wbg_buffer_3f3d764d4747d564=function(e){const n=E(e).buffer;return B(n)},t.wbg.__wbg_new_8c3f0052272a457a=function(e){const n=new Uint8Array(E(e));return B(n)},t.wbg.__wbg_set_83db9690f9353e79=function(e,n,l){E(e).set(E(n),l>>>0)},t.wbg.__wbg_length_9e1ae1900cb0fbd5=function(e){return E(e).length},t.wbg.__wbg_instanceof_Uint8Array_971eeda69eb75003=function(e){let n;try{n=E(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbindgen_debug_string=function(e,n){const l=Se(E(n)),s=He(l,X.__wbindgen_malloc,X.__wbindgen_realloc),o=ke;le()[e/4+1]=o,le()[e/4+0]=s},t.wbg.__wbindgen_throw=function(e,n){throw new Error(Ee(e,n))},t.wbg.__wbindgen_memory=function(){const e=X.memory;return B(e)},t}function Ht(t,e){return X=t.exports,ht.__wbindgen_wasm_module=e,ve=new Float64Array,ye=new Int32Array,me=new Uint8Array,X}async function ht(t){typeof t>"u"&&(t=new URL(""+new URL("../assets/xword_puz_bg.2a440b26.wasm",import.meta.url).href,self.location));const e=qt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:l}=await Nt(await t,e);return Ht(n,l)}const gt=(t,e)=>{let n=[];for(let l=0;l<t.length;l+=e){const s=t.substring(l,l+e);n.push(s)}return n},Kt=(t,e)=>t.reduce((n,l,s)=>{let o=e(l,s);return o!=null&&n.push(o),n},[]),Gt=t=>(e,n)=>{const l=t(e),s=t(n);for(let o=0;o<l.length;o++){if(l[o]<s[o])return-1;if(l[o]>s[o])return 1}return 0};const{window:Jt}=Ot;function Ke(t,e,n){const l=t.slice();return l[47]=e[n],l[49]=n,l}function Ge(t,e,n){const l=t.slice();l[47]=e[n],l[53]=n;const s=l[2][P*l[49]+l[53]];l[50]=s;const o=l[1]&&l[1].x==l[53]&&l[1].y==l[49];return l[51]=o,l}function Je(t){let e;return{c(){e=H(" Selected")},l(n){e=K(n," Selected")},m(n,l){N(n,e,l)},d(n){n&&m(e)}}}function Xe(t){let e,n=t[50].number+"",l;return{c(){e=D("span"),l=H(n),this.h()},l(s){e=L(s,"SPAN",{class:!0});var o=R(e);l=K(o,n),o.forEach(m),this.h()},h(){A(e,"class","cell-number svelte-zjvojk")},m(s,o){N(s,e,o),v(e,l)},p(s,o){o[0]&4&&n!==(n=s[50].number+"")&&oe(l,n)},d(s){s&&m(e)}}}function Ze(t){let e,n,l,s=t[50].fill+"",o,r,c,u,d=t[50].number&&Xe(t);function I(..._){return t[23](t[53],t[49],..._)}function F(..._){return t[24](t[53],t[49],..._)}function z(..._){return t[25](t[53],t[49],..._)}return{c(){e=D("div"),d&&d.c(),n=Z(),l=D("span"),o=H(s),r=Z(),this.h()},l(_){e=L(_,"DIV",{class:!0});var i=R(e);d&&d.l(i),n=Q(i),l=L(i,"SPAN",{class:!0});var f=R(l);o=K(f,s),f.forEach(m),r=Q(i),i.forEach(m),this.h()},h(){A(l,"class","cell-fill svelte-zjvojk"),A(e,"class","cell svelte-zjvojk"),se(e,"selected-area",t[14](t[1],t[53],t[49])),se(e,"selected",t[51]),se(e,"wall",t[50].wall),se(e,"error",t[50].fill.length>0&&t[50].fill.length<t[0])},m(_,i){N(_,e,i),d&&d.m(e,null),v(e,n),v(e,l),v(l,o),v(e,r),c||(u=[Y(e,"mousedown",I),Y(e,"mouseover",F),Y(e,"contextmenu",z)],c=!0)},p(_,i){t=_,t[50].number?d?d.p(t,i):(d=Xe(t),d.c(),d.m(e,n)):d&&(d.d(1),d=null),i[0]&4&&s!==(s=t[50].fill+"")&&oe(o,s),i[0]&16386&&se(e,"selected-area",t[14](t[1],t[53],t[49])),i[0]&2&&se(e,"selected",t[51]),i[0]&4&&se(e,"wall",t[50].wall),i[0]&5&&se(e,"error",t[50].fill.length>0&&t[50].fill.length<t[0])},d(_){_&&m(e),d&&d.d(),c=!1,Le(u)}}}function Qe(t){let e,n=te({length:P}),l=[];for(let s=0;s<n.length;s+=1)l[s]=Ze(Ge(t,n,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Ve()},l(s){for(let o=0;o<l.length;o+=1)l[o].l(s);e=Ve()},m(s,o){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(s,o);N(s,e,o)},p(s,o){if(o[0]&23559){n=te({length:P});let r;for(r=0;r<n.length;r+=1){const c=Ge(s,n,r);l[r]?l[r].p(c,o):(l[r]=Ze(c),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(s){s&&m(e),ge(l,s)}}}function Ye(t){let e,n,l=t[7].number+"",s,o,r,c,u,d,I,F,z=t[6].number+"",_,i,f,p,y,g,T;return{c(){e=D("div"),n=D("label"),s=H(l),o=H("A"),r=Z(),c=D("div"),u=D("input"),d=Z(),I=D("div"),F=D("label"),_=H(z),i=H("D"),f=Z(),p=D("div"),y=D("input"),this.h()},l(h){e=L(h,"DIV",{class:!0});var j=R(e);n=L(j,"LABEL",{for:!0,class:!0});var b=R(n);s=K(b,l),o=K(b,"A"),b.forEach(m),r=Q(j),c=L(j,"DIV",{class:!0});var S=R(c);u=L(S,"INPUT",{id:!0,class:!0,type:!0}),S.forEach(m),j.forEach(m),d=Q(h),I=L(h,"DIV",{class:!0});var C=R(I);F=L(C,"LABEL",{for:!0,class:!0});var V=R(F);_=K(V,z),i=K(V,"D"),V.forEach(m),f=Q(C),p=L(C,"DIV",{class:!0});var G=R(p);y=L(G,"INPUT",{id:!0,class:!0,type:!0}),G.forEach(m),C.forEach(m),this.h()},h(){A(n,"for","across-clue"),A(n,"class","svelte-zjvojk"),A(u,"id","across-clue"),A(u,"class","fill-width svelte-zjvojk"),A(u,"type","text"),A(c,"class","flex-container svelte-zjvojk"),A(e,"class","clue svelte-zjvojk"),A(F,"for","down-clue"),A(F,"class","svelte-zjvojk"),A(y,"id","down-clue"),A(y,"class","fill-width svelte-zjvojk"),A(y,"type","text"),A(p,"class","flex-container svelte-zjvojk"),A(I,"class","clue svelte-zjvojk")},m(h,j){N(h,e,j),v(e,n),v(n,s),v(n,o),v(e,r),v(e,c),v(c,u),re(u,t[7].acrossClue),N(h,d,j),N(h,I,j),v(I,F),v(F,_),v(F,i),v(I,f),v(I,p),v(p,y),re(y,t[6].downClue),g||(T=[Y(u,"input",t[27]),Y(y,"input",t[28])],g=!0)},p(h,j){j[0]&128&&l!==(l=h[7].number+"")&&oe(s,l),j[0]&128&&u.value!==h[7].acrossClue&&re(u,h[7].acrossClue),j[0]&64&&z!==(z=h[6].number+"")&&oe(_,z),j[0]&64&&y.value!==h[6].downClue&&re(y,h[6].downClue)},d(h){h&&(m(e),m(d),m(I)),g=!1,Le(T)}}}function Xt(t){let e,n,l,s,o,r,c,u,d,I,F,z,_,i,f,p,y,g=t[8]&&Je(),T=te({length:ce}),h=[];for(let b=0;b<T.length;b+=1)h[b]=Qe(Ke(t,T,b));let j=t[9]&&Ye(t);return{c(){e=D("div"),n=D("div"),l=D("div"),s=D("div"),o=D("input"),r=Z(),c=D("div"),u=H("by "),d=D("input"),I=Z(),F=D("button"),z=H("Export"),g&&g.c(),_=Z(),i=D("div");for(let b=0;b<h.length;b+=1)h[b].c();f=Z(),j&&j.c(),this.h()},l(b){e=L(b,"DIV",{id:!0,class:!0});var S=R(e);n=L(S,"DIV",{class:!0});var C=R(n);l=L(C,"DIV",{class:!0});var V=R(l);s=L(V,"DIV",{class:!0});var G=R(s);o=L(G,"INPUT",{class:!0,type:!0}),G.forEach(m),r=Q(V),c=L(V,"DIV",{class:!0});var fe=R(c);u=K(fe,"by "),d=L(fe,"INPUT",{class:!0,type:!0}),fe.forEach(m),V.forEach(m),I=Q(C),F=L(C,"BUTTON",{class:!0});var ie=R(F);z=K(ie,"Export"),g&&g.l(ie),ie.forEach(m),C.forEach(m),_=Q(S),i=L(S,"DIV",{id:!0,tabindex:!0,style:!0,class:!0});var be=R(i);for(let ae=0;ae<h.length;ae+=1)h[ae].l(be);be.forEach(m),f=Q(S),j&&j.l(S),S.forEach(m),this.h()},h(){A(o,"class","title fill-width svelte-zjvojk"),A(o,"type","text"),A(s,"class","flex-container svelte-zjvojk"),A(d,"class","fill-width svelte-zjvojk"),A(d,"type","text"),A(c,"class","flex-container svelte-zjvojk"),A(l,"class","meta svelte-zjvojk"),A(F,"class","svelte-zjvojk"),A(n,"class","header"),A(i,"id","grid"),A(i,"tabindex","0"),Mt(i,"grid-template-columns","repeat("+P+", 1fr)"),A(i,"class","svelte-zjvojk"),A(e,"id","grid-wrapper"),A(e,"class","svelte-zjvojk")},m(b,S){N(b,e,S),v(e,n),v(n,l),v(l,s),v(s,o),re(o,t[4]),v(l,r),v(l,c),v(c,u),v(c,d),re(d,t[5]),v(n,I),v(n,F),v(F,z),g&&g.m(F,null),v(e,_),v(e,i);for(let C=0;C<h.length;C+=1)h[C]&&h[C].m(i,null);t[26](i),v(e,f),j&&j.m(e,null),p||(y=[Y(Jt,"mouseup",t[20]),Y(o,"input",t[21]),Y(d,"input",t[22]),Y(F,"click",t[15]),Y(i,"keydown",t[13]),Y(i,"contextmenu",Zt)],p=!0)},p(b,S){if(S[0]&16&&o.value!==b[4]&&re(o,b[4]),S[0]&32&&d.value!==b[5]&&re(d,b[5]),b[8]?g||(g=Je(),g.c(),g.m(F,null)):g&&(g.d(1),g=null),S[0]&23559){T=te({length:ce});let C;for(C=0;C<T.length;C+=1){const V=Ke(b,T,C);h[C]?h[C].p(V,S):(h[C]=Qe(V),h[C].c(),h[C].m(i,null))}for(;C<h.length;C+=1)h[C].d(1);h.length=T.length}b[9]?j?j.p(b,S):(j=Ye(b),j.c(),j.m(e,null)):j&&(j.d(1),j=null)},i:he,o:he,d(b){b&&m(e),g&&g.d(),ge(h,b),t[26](null),j&&j.d(),p=!1,Le(y)}}}const ce=20,P=20,Zt=t=>t.preventDefault();function Qt(t,e,n){let l,s,o,r,c,{cellFillLen:u}=e;const d=a=>gt(a,u),I=ct();let F,z="Untitled",_="Anonymous",i=null,f=Array(P*ce).fill(null).map(()=>({wall:!1,fill:"",number:null,downClue:null,acrossClue:null}));const p=a=>{n(1,i={x:a.x,y:a.y,x2:a.x,y2:a.y}),y()},y=()=>{if(!i)return;let a=i.y*P+i.x;I("update",{downPattern:b(i),acrossPattern:j(i),cell:f[a]})},g=a=>({x:k,y:w,...U})=>a({x:k,y:w,...U,front:0,back:f.length,step:P}),T=a=>({x:k,y:w,...U})=>{const O=w*P;return a({x:k,y:w,...U,front:O,back:O+P,step:1})},h=({front:a,back:k,step:w,x:U,y:O})=>{let x=-1,M=O*P+U;if(f[M].wall)return null;for(;M>=a&&!f[M].wall;M-=w)x++;const $=M+w,W=[];for(M=$;M<k&&!f[M].wall;M+=w){const ee=f[M].fill;(!ee.length||ee.length==u)&&W.push(ee)}return{pattern:W,index:x}},j=T(h),b=g(h),S=({front:a,back:k,step:w,x:U,y:O,word:q,pivotIdx:x})=>{let M=O*P+U-x*w;a<=M-w&&(n(2,f[M-w].fill="",f),n(2,f[M-w].wall=!0,f));for(const $ of d(q))n(2,f[M].fill=$,f),n(2,f[M].wall=!1,f),M+=w;M<k&&(n(2,f[M].fill="",f),n(2,f[M].wall=!0,f)),F.focus(),Fe(),y()},C=T(S),V=g(S),G=({...a})=>C({...i,...a}),fe=({...a})=>V({...i,...a}),ie=({front:a,step:k,x:w,y:U,grid:O})=>{if(w==null||U==null)return{};let q=w+P*U;if(!O[q])return null;for(;q>=a&&!O[q].wall;q-=k);return O[q+k]},be=T(ie),ae=g(ie),mt=a=>{let k=i.y*P+i.x;n(2,f[k].wall=!1,f),n(2,f[k].fill=a,f),F.focus(),y()},Me=(a,k,w)=>{a.preventDefault();const U=w*P+k;n(2,f[U].wall^=!0,f),f[U].wall&&n(2,f[U].fill="",f),Fe(),y()},Re=(a,k,w)=>{let U=1;const O=({idx:x,topBounded:M,leftBounded:$})=>{const W=a[x],ee=M||$;W.number=null,M?W.downClue??(W.downClue=""):W.downClue=null,$?W.acrossClue??(W.acrossClue=""):W.acrossClue=null,!W.wall&&ee&&(W.number=U,U++)};let q=!0;for(let x=0;x<k;x++)O({idx:x,topBounded:!0,leftBounded:q}),q=a[x].wall;for(let x=1;x<w;x++){const M=x*k,$=a[M-k].wall;O({idx:M,topBounded:$,leftBounded:!0});for(let W=1;W<k;W++){const ee=M+W,Oe=a[ee-k].wall,J=a[ee-1].wall;O({idx:ee,topBounded:Oe,leftBounded:J})}}},Fe=()=>Re(f,P,ce),Te=({event:a,x:k,y:w})=>{a.buttons!=1||(i==null?void 0:i.state)!=="area"||(n(1,i.x2=k,i),n(1,i.y2=w,i))},pt=a=>{switch(a.keyCode){case 37:a.preventDefault(),i&&i.x>0&&p({x:i.x-1,y:i.y});break;case 38:a.preventDefault(),i&&i.y>0&&p({x:i.x,y:i.y-1});break;case 39:a.preventDefault(),i&&i.x<P-1&&p({x:i.x+1,y:i.y});break;case 40:a.preventDefault(),i&&i.y<ce-1&&p({x:i.x,y:i.y+1});break;case 8:if(!i)return;const k=i.y*P+i.x;f[k].fill.length?(n(2,f[k].fill="",f),y()):i.x!=0&&!f[k-1].wall&&p({x:i.x-1,y:i.y});break;default:if(!i||a.ctrlKey||a.altKey||a.metaKey)return;if(a.keyCode>64&&a.keyCode<91){const w=String.fromCharCode(a.keyCode),U=i.y*P+i.x;if(f[U].wall)return;f[U].fill.length<u&&(n(2,f[U].fill+=w,f),y())}}},yt=(a,k,w)=>{if(!a)return!1;const U=Math.min(a.x,a.x2),O=Math.max(a.x,a.x2),q=Math.min(a.y,a.y2),x=Math.max(a.y,a.y2);return U<=k&&k<=O&&q<=w&&w<=x},vt=(a,k)=>{const w=document.createElement("a");w.href=a,w.download=k,document.body.appendChild(w),w.style.display="none",w.click(),w.remove()},kt=(a,k,w)=>{const U=new Blob([a],{type:w}),O=window.URL.createObjectURL(U);vt(O,k),setTimeout(()=>window.URL.revokeObjectURL(O),1e3)},At=()=>{let a,k,w,U;o?(a=Math.min(i.x,i.x2),k=Math.max(i.x,i.x2),w=Math.min(i.y,i.y2),U=Math.max(i.y,i.y2)):(a=0,w=0,k=P-1,U=ce-1);const O=[],q=U-w+1,x=k-a+1;for(let J=w;J<=U;J++)for(let je=a;je<=k;je++){const Ut=J*P+je;O.push({...f[Ut]})}Re(O,q,x);const M=[],$=[];for(const J of O)J.acrossClue!=null&&M.push([J.number,J.acrossClue]),J.downClue!=null&&$.push([J.number,J.downClue]);const W=O.map(J=>J.wall?null:J.fill),ee=Bt({width:q,height:x,grid:W,acrossClues:M,downClues:$,title:z,author:_});kt(ee,`${z||"Untitled"}.puz`,"application/octet-stream")};Fe(),ut(async()=>{await ht()});const Ft=()=>i&&n(1,i.state=null,i);function jt(){z=this.value,n(4,z)}function Et(){_=this.value,n(5,_)}const It=(a,k,w)=>{w.buttons===1&&(p({x:a,y:k}),n(1,i.state="area",i))},Ct=(a,k,w)=>Te({event:w,x:a,y:k}),St=(a,k,w)=>Me(w,a,k);function Dt(a){ft[a?"unshift":"push"](()=>{F=a,n(3,F)})}function Lt(){r.acrossClue=this.value,n(7,r),n(1,i),n(2,f)}function zt(){c.downClue=this.value,n(6,c),n(1,i),n(2,f)}return t.$$set=a=>{"cellFillLen"in a&&n(0,u=a.cellFillLen)},t.$$.update=()=>{t.$$.dirty[0]&6&&n(19,l=i&&f[i.x+i.y*P]),t.$$.dirty[0]&524288&&n(9,s=l&&!l.wall),t.$$.dirty[0]&2&&n(8,o=i&&(i.x!=i.x2||i.y!=i.y2)),t.$$.dirty[0]&6&&n(7,r=be({...i,grid:f})),t.$$.dirty[0]&6&&n(6,c=ae({...i,grid:f}))},[u,i,f,F,z,_,c,r,o,s,p,Me,Te,pt,yt,At,G,fe,mt,l,Ft,jt,Et,It,Ct,St,Dt,Lt,zt]}class Yt extends ze{constructor(e){super(),Ue(this,e,Qt,Xt,De,{cellFillLen:0,setAcrossFillAtSelected:16,setDownFillAtSelected:17,setFillAtSelected:18},null,[-1,-1])}get setAcrossFillAtSelected(){return this.$$.ctx[16]}get setDownFillAtSelected(){return this.$$.ctx[17]}get setFillAtSelected(){return this.$$.ctx[18]}}function $e(t,e,n){const l=t.slice();return l[10]=e[n],l}function et(t,e,n){const l=t.slice();return l[13]=e[n],l}function tt(t,e,n){const l=t.slice();return l[13]=e[n],l}function $t(t){let e,n='<img class="spinner svelte-1q31v9d" src="spinner.gif" alt="loading fill suggestions"/>';return{c(){e=D("div"),e.innerHTML=n,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),Rt(e)!=="svelte-wds5ea"&&(e.innerHTML=n),this.h()},h(){A(e,"class","spinner-container svelte-1q31v9d")},m(l,s){N(l,e,s)},p:he,d(l){l&&m(e)}}}function en(t){var T,h,j;let e,n,l=(((T=t[1])==null?void 0:T.length)??"?")+"",s,o,r,c,u=(((h=t[2])==null?void 0:h.length)??"?")+"",d,I,F,z,_=(((j=t[3])==null?void 0:j.length)??"?")+"",i,f,p=t[1]&&nt(t),y=t[2]&&st(t),g=t[3]&&ot(t);return{c(){e=D("ul"),n=D("li"),s=H(l),o=H(` potential across fills.
        `),p&&p.c(),r=Z(),c=D("li"),d=H(u),I=H(` potential down fills.
        `),y&&y.c(),F=Z(),z=D("li"),i=H(_),f=H(` potential fills for this cell:
        `),g&&g.c()},l(b){e=L(b,"UL",{});var S=R(e);n=L(S,"LI",{});var C=R(n);s=K(C,l),o=K(C,` potential across fills.
        `),p&&p.l(C),C.forEach(m),r=Q(S),c=L(S,"LI",{});var V=R(c);d=K(V,u),I=K(V,` potential down fills.
        `),y&&y.l(V),V.forEach(m),F=Q(S),z=L(S,"LI",{});var G=R(z);i=K(G,_),f=K(G,` potential fills for this cell:
        `),g&&g.l(G),G.forEach(m),S.forEach(m)},m(b,S){N(b,e,S),v(e,n),v(n,s),v(n,o),p&&p.m(n,null),v(e,r),v(e,c),v(c,d),v(c,I),y&&y.m(c,null),v(e,F),v(e,z),v(z,i),v(z,f),g&&g.m(z,null)},p(b,S){var C,V,G;S&2&&l!==(l=(((C=b[1])==null?void 0:C.length)??"?")+"")&&oe(s,l),b[1]?p?p.p(b,S):(p=nt(b),p.c(),p.m(n,null)):p&&(p.d(1),p=null),S&4&&u!==(u=(((V=b[2])==null?void 0:V.length)??"?")+"")&&oe(d,u),b[2]?y?y.p(b,S):(y=st(b),y.c(),y.m(c,null)):y&&(y.d(1),y=null),S&8&&_!==(_=(((G=b[3])==null?void 0:G.length)??"?")+"")&&oe(i,_),b[3]?g?g.p(b,S):(g=ot(b),g.c(),g.m(z,null)):g&&(g.d(1),g=null)},d(b){b&&m(e),p&&p.d(),y&&y.d(),g&&g.d()}}}function nt(t){let e,n=te(t[1].slice(0,Ae)),l=[];for(let s=0;s<n.length;s+=1)l[s]=lt(tt(t,n,s));return{c(){e=D("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=L(s,"DIV",{class:!0});var o=R(e);for(let r=0;r<l.length;r+=1)l[r].l(o);o.forEach(m),this.h()},h(){A(e,"class","word-grid svelte-1q31v9d")},m(s,o){N(s,e,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(s,o){if(o&50){n=te(s[1].slice(0,Ae));let r;for(r=0;r<n.length;r+=1){const c=tt(s,n,r);l[r]?l[r].p(c,o):(l[r]=lt(c),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(s){s&&m(e),ge(l,s)}}}function lt(t){let e,n,l=t[5](t[13])+"",s,o,r;function c(){return t[7](t[13])}return{c(){e=D("a"),n=new at(!1),s=Z(),this.h()},l(u){e=L(u,"A",{class:!0});var d=R(e);n=dt(d,!1),s=Q(d),d.forEach(m),this.h()},h(){n.a=s,A(e,"class","svelte-1q31v9d")},m(u,d){N(u,e,d),n.m(l,e),v(e,s),o||(r=Y(e,"click",c),o=!0)},p(u,d){t=u,d&2&&l!==(l=t[5](t[13])+"")&&n.p(l)},d(u){u&&m(e),o=!1,r()}}}function st(t){let e,n=te(t[2].slice(0,Ae)),l=[];for(let s=0;s<n.length;s+=1)l[s]=rt(et(t,n,s));return{c(){e=D("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=L(s,"DIV",{class:!0});var o=R(e);for(let r=0;r<l.length;r+=1)l[r].l(o);o.forEach(m),this.h()},h(){A(e,"class","word-grid svelte-1q31v9d")},m(s,o){N(s,e,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(s,o){if(o&52){n=te(s[2].slice(0,Ae));let r;for(r=0;r<n.length;r+=1){const c=et(s,n,r);l[r]?l[r].p(c,o):(l[r]=rt(c),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(s){s&&m(e),ge(l,s)}}}function rt(t){let e,n,l=t[5](t[13])+"",s,o,r;function c(){return t[8](t[13])}return{c(){e=D("a"),n=new at(!1),s=Z(),this.h()},l(u){e=L(u,"A",{class:!0});var d=R(e);n=dt(d,!1),s=Q(d),d.forEach(m),this.h()},h(){n.a=s,A(e,"class","svelte-1q31v9d")},m(u,d){N(u,e,d),n.m(l,e),v(e,s),o||(r=Y(e,"click",c),o=!0)},p(u,d){t=u,d&4&&l!==(l=t[5](t[13])+"")&&n.p(l)},d(u){u&&m(e),o=!1,r()}}}function ot(t){let e,n=te(t[3]),l=[];for(let s=0;s<n.length;s+=1)l[s]=it($e(t,n,s));return{c(){e=D("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=L(s,"DIV",{class:!0});var o=R(e);for(let r=0;r<l.length;r+=1)l[r].l(o);o.forEach(m),this.h()},h(){A(e,"class","letter-grid svelte-1q31v9d")},m(s,o){N(s,e,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(s,o){if(o&24){n=te(s[3]);let r;for(r=0;r<n.length;r+=1){const c=$e(s,n,r);l[r]?l[r].p(c,o):(l[r]=it(c),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(s){s&&m(e),ge(l,s)}}}function it(t){let e,n=t[10]+"",l,s,o;function r(){return t[9](t[10])}return{c(){e=D("a"),l=H(n),this.h()},l(c){e=L(c,"A",{class:!0});var u=R(e);l=K(u,n),u.forEach(m),this.h()},h(){A(e,"class","svelte-1q31v9d")},m(c,u){N(c,e,u),v(e,l),s||(o=Y(e,"click",r),s=!0)},p(c,u){t=c,u&8&&n!==(n=t[10]+"")&&oe(l,n)},d(c){c&&m(e),s=!1,o()}}}function tn(t){let e;function n(o,r){return o[0]?en:$t}let l=n(t),s=l(t);return{c(){e=D("div"),s.c(),this.h()},l(o){e=L(o,"DIV",{id:!0,class:!0});var r=R(e);s.l(r),r.forEach(m),this.h()},h(){A(e,"id","cell-data"),A(e,"class","svelte-1q31v9d")},m(o,r){N(o,e,r),s.m(e,null)},p(o,[r]){l===(l=n(o))&&s?s.p(o,r):(s.d(1),s=l(o),s&&(s.c(),s.m(e,null)))},i:he,o:he,d(o){o&&m(e),s.d()}}}const Ae=100;function nn(t,e,n){let{dict:l}=e,{acrossFills:s}=e,{downFills:o}=e,{cellFills:r}=e,{cellFillLen:c}=e;const u=ct(),d=({entry:_,pivotIdx:i})=>{const f=i*c,p=f+c,y=_.word.slice(0,f),g=_.word.slice(f,p),T=_.word.slice(p);return`${y}<strong>${g}</strong>${T}`},I=_=>u("fillAcross",{word:_.entry.word,pivotIdx:_.pivotIdx}),F=_=>u("fillDown",{word:_.entry.word,pivotIdx:_.pivotIdx}),z=_=>u("fillCell",{fill:_});return t.$$set=_=>{"dict"in _&&n(0,l=_.dict),"acrossFills"in _&&n(1,s=_.acrossFills),"downFills"in _&&n(2,o=_.downFills),"cellFills"in _&&n(3,r=_.cellFills),"cellFillLen"in _&&n(6,c=_.cellFillLen)},[l,s,o,r,u,d,c,I,F,z]}class ln extends ze{constructor(e){super(),Ue(this,e,nn,tn,De,{dict:0,acrossFills:1,downFills:2,cellFills:3,cellFillLen:6})}}const bt=2,wt=t=>gt(t,bt),sn=async()=>{const e=await(await fetch("/dict/words.txt")).text(),n=Kt(e.split(`
`),on),l=new Map;for(const s of n){const o=s.chunks;delete s.chunks;for(const r of o){const c=l.get(r)||[];c.push(s),l.set(r,c)}}return{entries:n,chunkIndex:l,filterFit:rn}};function rn(t,e){let n=[],l=new Set;const s=r=>{let c=t[r],u=this.chunkIndex.get(c)||[];for(const d of u){const I=wt(d.word);for(const[F,z]of I.entries())if(z==c){const _=r-F,i=_+I.length,f=e-_;if(f<0||f>=I.length)continue;const p=I[f];if(_<0||_>0&&t[_-1]||i>t.length||i<t.length&&t[i]||!I.every((g,T)=>{const h=t[_+T];return!h||h==g}))continue;n.push({entry:d,pivotIdx:f}),l.add(p)}}};if(t[e])s(e);else{for(let r=e;r>=0;r--)if(t[r]){s(r);break}for(let r=e;r<t.length;r++)if(t[r]){s(r);break}}n.sort(Gt(r=>[-r.entry.score,r.entry.word,r.pivotIdx]));let o=null;return n=n.reduce((r,c)=>(o&&c.pivotIdx==o.pivotIdx&&c.entry==o.entry||(r.push(c),o=c),r),[]),{gridFills:n,cellFills:l}}const on=t=>{let[e,n]=t.split(";");if(!e.match(`^([A-Z]{${bt}})+$`))return null;const l=new Set(wt(e));return n=+n,{word:e,score:n,chunks:l}};function cn(t){let e,n,l,s,o,r,c={cellFillLen:ue};return l=new Yt({props:c}),t[6](l),l.$on("update",t[5]),o=new ln({props:{dict:t[1],downFills:t[2],acrossFills:t[3],cellFills:t[4],cellFillLen:ue}}),o.$on("fillAcross",t[7]),o.$on("fillDown",t[8]),o.$on("fillCell",t[9]),{c(){e=Z(),n=D("div"),Pe(l.$$.fragment),s=Z(),Pe(o.$$.fragment),this.h()},l(u){Tt("svelte-ckbzzi",document.head).forEach(m),e=Q(u),n=L(u,"DIV",{id:!0,class:!0});var I=R(n);xe(l.$$.fragment,I),s=Q(I),xe(o.$$.fragment,I),I.forEach(m),this.h()},h(){document.title="Pair XWord Setter",A(n,"id","body-wrapper"),A(n,"class","svelte-i647o8")},m(u,d){N(u,e,d),N(u,n,d),We(l,n,null),v(n,s),We(o,n,null),r=!0},p(u,[d]){const I={};l.$set(I);const F={};d&2&&(F.dict=u[1]),d&4&&(F.downFills=u[2]),d&8&&(F.acrossFills=u[3]),d&16&&(F.cellFills=u[4]),o.$set(F)},i(u){r||(Be(l.$$.fragment,u),Be(o.$$.fragment,u),r=!0)},o(u){Ne(l.$$.fragment,u),Ne(o.$$.fragment,u),r=!1},d(u){u&&(m(e),m(n)),t[6](null),qe(l),qe(o)}}}const ue=2;function un(t,e,n){let l,s=null,o=null,r=null,c=null;ut(async()=>{n(1,s=await sn())});const u=(i,f)=>{if(!i||!f)return i||f;let p=new Set;for(const y of f)i.has(y)&&p.add(y);return p},d=i=>{var y;if((y=i.detail.cell)!=null&&y.wall){n(2,o=null),n(3,r=null),n(4,c=null);return}let f;const p=({pattern:g,index:T})=>{if(g.some(h=>h)){const{gridFills:h,cellFills:j}=s.filterFit(g,T);return f=u(f,j),h}return null};n(2,o=p(i.detail.downPattern)),n(3,r=p(i.detail.acrossPattern)),n(2,o=o==null?void 0:o.filter(({entry:g,pivotIdx:T})=>{let h=T*ue,j=g.word.slice(h,h+ue);return f.has(j)})),n(3,r=r==null?void 0:r.filter(({entry:g,pivotIdx:T})=>{let h=T*ue,j=g.word.slice(h,h+ue);return f.has(j)})),f!=null?(n(4,c=[...f]),c.sort()):n(4,c=null)};function I(i){ft[i?"unshift":"push"](()=>{l=i,n(0,l)})}return[l,s,o,r,c,d,I,i=>l.setAcrossFillAtSelected(i.detail),i=>l.setDownFillAtSelected(i.detail),i=>l.setFillAtSelected(i.detail.fill)]}class dn extends ze{constructor(e){super(),Ue(this,e,un,cn,De,{})}}export{dn as component};
